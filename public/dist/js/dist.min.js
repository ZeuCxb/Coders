angular.module("coders",["ngRoute"]),angular.module("coders").config(["$routeProvider",function(e){e.when("/",{templateUrl:"views/home.html"}),e.when("/page/:_id",{templateUrl:"views/page.html"}),e.when("/search/:search",{templateUrl:"views/search.html"}).otherwise({redirectTo:"/"})}]),angular.module("coders").run(["$rootScope",function(e){return e.$on("connect",function(r,o){return e.$broadcast("connected",o)})}]),angular.module("coders").controller("appCtrl",["codersApi","codersAppUser","$location","$window","$scope",function(e,r,o,n,t){var s,u;u=this,s=function(){return e.connect().then(function(e){return u.user=e.data,r.setAppUser(u.user),t.$emit("connect",u.user)},function(){return u.user={}})},u.logOn=function(){var r;return u.logonUser?(r=u.logonUser,delete r.cpass,r.email=r.email.toLowerCase(),r.name=r.name.toLowerCase(),r.nick=r.nick.toLowerCase(),e.logon(r).then(function(e){return n.location.reload()},function(e){var r,o;if("error"===e.status){if(!e.data)return n.location.reload();if(r=e.data.errmsg.search("email"),o=e.data.errmsg.search("nick"),u.error={},r>0&&(u.error.email=!0),o>0)return u.error.nick=!0}})):void 0},u.logIn=function(){var r;return u.loginUser?(r=u.loginUser,r.login=r.login.toLowerCase(),e.login(r).then(function(e){return n.location.reload()},function(e){return u.error={},console.log(e),u.error.login=!0,u.error.pass=!0})):void 0},u.logOut=function(){return u.user?e.logout().then(function(){return n.location.reload()}):void 0},s()}]),angular.module("coders").controller("pageCtrl",["$routeParams","codersApi","codersAppUser",function(e,r,o){var n,t,s;n=e._id,s=this,s.page={},s.user=o.getAppUser(),(t=function(){return r.getUser(n).then(function(e){return s.page.user=e.data,s.user&&s.user._id===e.data._id?s.page.my=!0:s.page.my=!1},function(e){return s.page.error=e})})()}]),angular.module("coders").controller("searchCtrl",["$routeParams","codersApi","codersAppUser",function(e,r,o){var n,t,s;t=e.search,s=this,s.user=o.getAppUser(),(n=function(){return r.findUsers(t).then(function(e){return"success"===e.status?s.foundUsers=e.data:void 0})})()}]),angular.module("coders").controller("titleCtrl",["$scope",function(e){var r;r=this,r.title="CSC - A Social Community to learn, teach and grow up.",e.$on("connected",function(e,o){return o?r.title="CSC - "+o.nick+" ("+o.name+")":void 0})}]),angular.module("coders").factory("codersApi",["$q","$http",function(e,r){var o,n,t,s,u,c,a,i,l,d,g,f,p;return i="http://localhost:5000/",d=i+"register",l=i+"login",g=i+"logout",f=i+"user",p=i+"users",o=function(){var o;return o=e.defer(),r.get(l).success(o.resolve).error(o.reject),o.promise},t=function(e){return'{"user": '+JSON.stringify(e)+"}"},c=function(o){var n;return n=e.defer(),o=t(o),r.post(d,o).success(n.resolve).error(n.reject),n.promise},u=function(o){var n;return n=e.defer(),o=t(o),r.post(l,o).success(n.resolve).error(n.reject),n.promise},a=function(){var o;return o=e.defer(),r.get(g).success(o.resolve).error(o.reject),o.promise},s=function(o){var n;return n=e.defer(),r.get(f+"/"+o).success(n.resolve).error(n.reject),n.promise},n=function(o){var n;return n=e.defer(),r.get(p+"/"+o).success(n.resolve).error(n.resolve),n.promise},{logon:c,login:u,connect:o,logout:a,getUser:s,findUsers:n}}]),angular.module("coders").factory("codersAppUser",[function(){var e,r,o;return r=this,r.user={},o=function(e){return r.user=e},e=function(){return r.user},{setAppUser:o,getAppUser:e}}]),angular.module("csView",[]);