angular.module("coders",["ngRoute"]),angular.module("coders").config(["$routeProvider",function(e){e.when("/",{templateUrl:"views/home.html"}),e.when("/page/:_id",{templateUrl:"views/page.html"}),e.when("/search/:search",{templateUrl:"views/search.html"}).otherwise({redirectTo:"/"})}]),angular.module("coders").run(["$rootScope",function(e){return e.$on("connect",function(r,o){return e.$broadcast("connected",o)})}]),angular.module("coders").controller("appCtrl",["codersApi","codersAppUser","$location","$window","$scope",function(e,r,o,t,n){var s,u;u=this,s=function(){return e.connect().then(function(e){return u.user=e.data,r.setAppUser(u.user),n.$emit("connect",u.user)},function(){return u.user={}})},u.logOn=function(){var r;return u.logonUser?(r=u.logonUser,delete r.cpass,r.email=r.email.toLowerCase(),r.name=r.name.toLowerCase(),r.nick=r.nick.toLowerCase(),e.logon(r).then(function(e){return t.location.reload()},function(e){var r,o;if("error"===e.status){if(!e.data)return t.location.reload();if(r=e.data.errmsg.search("email"),o=e.data.errmsg.search("nick"),u.error={},r>0&&(u.error.email=!0),o>0)return u.error.nick=!0}})):void 0},u.logIn=function(){var r;return u.loginUser?(r=u.loginUser,r.login=r.login.toLowerCase(),e.login(r).then(function(e){return t.location.reload()},function(e){return u.error={},console.log(e),u.error.login=!0,u.error.pass=!0})):void 0},u.logOut=function(){return u.user?e.logout().then(function(){return t.location.reload()}):void 0},s()}]),angular.module("coders").controller("pageCtrl",["$routeParams","codersApi","codersAppUser",function(e,r,o){var t,n,s,u;t=e._id,u=this,u.page={},u.user=o.getAppUser(),s=function(){return r.getPost(t).then(function(e){return u.post=e.data},function(){return u.post=!1})},n=function(){return r.getUser(t).then(function(e){return u.page.user=e.data,u.user&&u.user._id===e.data._id?u.page.my=!0:u.page.my=!1},function(e){return u.page.error=e}),s()},u.sendPost=function(){var e;return e={},e.text=u.msg,e.user=u.user._id,r.post(e).then(function(e){return s(),u.msg=""})},u.delPost=function(e){return r.delPost(e)},n()}]),angular.module("coders").controller("searchCtrl",["$routeParams","codersApi","codersAppUser",function(e,r,o){var t,n,s;n=e.search,s=this,s.user=o.getAppUser(),(t=function(){return r.findUsers(n).then(function(e){return"success"===e.status?s.foundUsers=e.data:void 0})})()}]),angular.module("coders").controller("titleCtrl",["$scope",function(e){var r;r=this,r.title="CSC - A Social Community to learn, teach and grow up.",e.$on("connected",function(e,o){return o?r.title="CSC - "+o.nick+" ("+o.name+")":void 0})}]),angular.module("coders").factory("codersApi",["$q","$http","$window",function(e,r,o){var t,n,s,u,c,i,a,l,d,f,g,p,m,v,h,U,w;return g="http://localhost:5000/",m=g+"register",p=g+"login",v=g+"logout",U=g+"user",w=g+"users",h=g+"post",t=function(){var o;return o=e.defer(),r.get(p).success(o.resolve).error(o.reject),o.promise},u=function(e){return'{"user": '+JSON.stringify(e)+"}"},l=function(o){var t;return t=e.defer(),o=u(o),r.post(m,o).success(t.resolve).error(t.reject),t.promise},a=function(o){var t;return t=e.defer(),o=u(o),r.post(p,o).success(t.resolve).error(t.reject),t.promise},d=function(){var o;return o=e.defer(),r.get(v).success(o.resolve).error(o.reject),o.promise},i=function(o){var t;return t=e.defer(),r.get(U+"/"+o).success(t.resolve).error(t.reject),t.promise},s=function(o){var t;return t=e.defer(),r.get(w+"/"+o).success(t.resolve).error(t.resolve),t.promise},f=function(o){var t;return t=e.defer(),o='{"message": '+JSON.stringify(o)+"}",r.post(h,o).success(t.resolve).error(t.reject),t.promise},c=function(o){var t;return t=e.defer(),r.get(h+"/"+o).success(t.resolve).error(t.reject),t.promise},n=function(e){return r["delete"](h+"/"+e).success(o.location.reload())},{logon:l,login:a,connect:t,logout:d,getUser:i,findUsers:s,post:f,getPost:c,delPost:n}}]),angular.module("coders").factory("codersAppUser",[function(){var e,r,o;return r=this,r.user={},o=function(e){return r.user=e},e=function(){return r.user},{setAppUser:o,getAppUser:e}}]),angular.module("csView",[]);